<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>core/schema.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-core_migrate-Migration.html">Migration</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_migrate-Migration.html#migrate">migrate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_migrate-Migration.html#upgrade">upgrade</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-core_migrate-Migrator.html">Migrator</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_migrate-Migrator.html#getLatestVersion">getLatestVersion</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_migrate-Migrator.html#isOudated">isOudated</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_migrate-Migrator.html#migrate">migrate</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-core_schema-DefaultValue.html">DefaultValue</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-DefaultValue.html#clone">clone</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-DefaultValue.html#flatten">flatten</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-DefaultValue.html#merge">merge</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-DefaultValue.html#toCommented">toCommented</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-DefaultValue.html#toCommentedArray">toCommentedArray</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-DefaultValue.html#toCommentedObject">toCommentedObject</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-DefaultValue.html#toYaml">toYaml</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-core_schema-Schema.html">Schema</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-Schema.html#getArrayDefaultValue">getArrayDefaultValue</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-Schema.html#getDefaultValue">getDefaultValue</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-Schema.html#getObjectDefaultValue">getObjectDefaultValue</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-Schema.html#getReferredDefaultValue">getReferredDefaultValue</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-Schema.html#getTypedDefaultValue">getTypedDefaultValue</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-Schema.html#validate">validate</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-core_schema-SchemaLoader.html">SchemaLoader</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-SchemaLoader.html#.load">load</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-SchemaLoader.html#addSchema">addSchema</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-SchemaLoader.html#compileValidator">compileValidator</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-SchemaLoader.html#getSchema">getSchema</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_schema-SchemaLoader.html#removeSchema">removeSchema</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_comment_changyan-ChangYan.html">ChangYan</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_comment_disqusjs-DisqusJs.html">DisqusJs</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_comment_disqus-Disqus.html">Disqus</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_comment_facebook-Facebook.html">Facebook</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_comment_gitalk-Gitalk.html">Gitalk</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_comment_gitment-Gitment.html">Gitment</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_comment_isso-Isso.html">Isso</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_comment_livere-LiveRe.html">LiveRe</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_comment_twikoo-Twikoo.html">Twikoo</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_comment_utterances-Utterances.html">Utterances</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_comment_valine-Valine.html">Valine</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_comment_waline-Waline.html">Waline</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_donate_afdian-Afdian.html">Afdian</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_donate_alipay-Alipay.html">Alipay</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_donate_alipay-Wechat.html">Wechat</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_donate_buymeacoffee-BuyMeACoffee.html">BuyMeACoffee</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_donate_patreon-Patreon.html">Patreon</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_donate_paypal-Paypal.html">Paypal</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_misc_article_licensing-ArticleLicensing.html">ArticleLicensing</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_misc_web_app-WebApp.html">WebApp</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_plugin_baidu_analytics-BaiduAnalytics.html">BaiduAnalytics</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_plugin_baidu_analytics-Busuanzi.html">Busuanzi</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_plugin_bing_webmaster-BingWebmaster.html">BingWebmaster</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_plugin_cnzz-Cnzz.html">Cnzz</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_plugin_cookie_consent-CookieConsent.html">CookieConsent</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_plugin_gallery-Gallery.html">Gallery</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_plugin_google_analytics-GoogleAnalytics.html">GoogleAnalytics</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_plugin_hotjar-Hotjar.html">Hotjar</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_plugin_katex-KaTeX.html">KaTeX</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_plugin_katex-Mathjax.html">Mathjax</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_plugin_outdated_browser-OutdatedBrowser.html">OutdatedBrowser</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_plugin_progressbar-ProgressBar.html">ProgressBar</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_plugin_statcounter-Statcounter.html">Statcounter</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_plugin_twitter_conversion_tracking-TwiterCT.html">TwiterCT</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_search_algolia-Algolia.html">Algolia</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_search_baidu-Baidu.html">Baidu</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_search_google_cse-GoogleCSE.html">GoogleCSE</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_search_insight-Insight.html">Insight</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_share_addthis-AddThis.html">AddThis</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_share_addtoany-AddToAny.html">AddToAny</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_share_bdshare-BdShare.html">BdShare</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_share_sharejs-ShareJs.html">ShareJs</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_share_sharethis-ShareThis.html">ShareThis</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_widget_adsense-AdSense.html">AdSense</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_widget_archives-Archives.html">Archives</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_widget_categories-Categories.html">Categories</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_widget_followit-FollowIt.html">FollowIt</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_widget_links-Links.html">Links</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_widget_recent_posts-RecentPosts.html">RecentPosts</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_widget_subscribe_email-SubscribeEmail.html">SubscribeEmail</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_widget_tags-Tags.html">Tags</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-view_widget_toc-Toc.html">Toc</a></span></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-core_migrate.html">core/migrate</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-core_schema.html">core/schema</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-core_view.html">core/view</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_view.html#.init">init</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_view.html#.require">require</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-core_view.html#~resolve">resolve</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-hexo_filter_locals.html">hexo/filter/locals</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-hexo_generator_assets.html">hexo/generator/assets</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-hexo_generator_categories.html">hexo/generator/categories</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-hexo_generator_category.html">hexo/generator/category</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-hexo_generator_insight.html">hexo/generator/insight</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-hexo_generator_manifest.html">hexo/generator/manifest</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-hexo_generator_tags.html">hexo/generator/tags</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-hexo_helper_cdn.html">hexo/helper/cdn</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-hexo_helper_page.html">hexo/helper/page</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-hexo_tag_message.html">hexo/tag/message</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-hexo_tag_tabs.html">hexo/tag/tabs</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-util_cache.html">util/cache</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-util_cache.html#.cacheComponent">cacheComponent</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-util_classname.html">util/classname</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-util_yaml.html">util/yaml</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-util_yaml.html#.parse">parse</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-util_yaml.html#.stringify">stringify</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_comment_changyan.html">view/comment/changyan</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_comment_disqus.html">view/comment/disqus</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_comment_disqusjs.html">view/comment/disqusjs</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_comment_facebook.html">view/comment/facebook</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_comment_gitalk.html">view/comment/gitalk</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_comment_gitment.html">view/comment/gitment</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_comment_isso.html">view/comment/isso</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_comment_livere.html">view/comment/livere</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_comment_twikoo.html">view/comment/twikoo</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_comment_utterances.html">view/comment/utterances</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_comment_valine.html">view/comment/valine</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_comment_waline.html">view/comment/waline</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_common_article_media.html">view/common/article_media</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_donate_afdian.html">view/donate/afdian</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_donate_alipay.html">view/donate/alipay</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_donate_buymeacoffee.html">view/donate/buymeacoffee</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_donate_patreon.html">view/donate/patreon</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_donate_paypal.html">view/donate/paypal</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_misc_article_licensing.html">view/misc/article_licensing</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_misc_meta.html">view/misc/meta</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_misc_open_graph.html">view/misc/open_graph</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_misc_paginator.html">view/misc/paginator</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_misc_structured_data.html">view/misc/structured_data</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_misc_web_app.html">view/misc/web_app</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_plugin_baidu_analytics.html">view/plugin/baidu_analytics</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_plugin_bing_webmaster.html">view/plugin/bing_webmaster</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_plugin_cnzz.html">view/plugin/cnzz</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_plugin_cookie_consent.html">view/plugin/cookie_consent</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_plugin_gallery.html">view/plugin/gallery</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_plugin_google_analytics.html">view/plugin/google_analytics</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_plugin_hotjar.html">view/plugin/hotjar</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_plugin_katex.html">view/plugin/katex</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_plugin_outdated_browser.html">view/plugin/outdated_browser</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_plugin_progressbar.html">view/plugin/progressbar</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_plugin_statcounter.html">view/plugin/statcounter</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_plugin_twitter_conversion_tracking.html">view/plugin/twitter_conversion_tracking</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_search_algolia.html">view/search/algolia</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_search_baidu.html">view/search/baidu</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_search_google_cse.html">view/search/google_cse</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_search_insight.html">view/search/insight</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_share_addthis.html">view/share/addthis</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_share_addtoany.html">view/share/addtoany</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_share_bdshare.html">view/share/bdshare</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_share_sharejs.html">view/share/sharejs</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_share_sharethis.html">view/share/sharethis</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_widget_adsense.html">view/widget/adsense</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_widget_archives.html">view/widget/archives</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_widget_categories.html">view/widget/categories</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_widget_followit.html">view/widget/followit</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_widget_links.html">view/widget/links</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_widget_recent_posts.html">view/widget/recent_posts</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_widget_subscribe_email.html">view/widget/subscribe_email</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_widget_tags.html">view/widget/tags</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-view_widget_toc.html">view/widget/toc</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">core/schema.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Configuration and validation.
 * @module core/schema
 */
const Ajv = require('ajv');
const path = require('path');
const yaml = require('../util/yaml');

/**
 * A magic string for reformating comment lines in the YAML output.
 */
const MAGIC = 'c823d4d4';

/**
 * Default value for the primitive types.
 * @access private
 */
const PRIMITIVE_DEFAULTS = {
  null: null,
  boolean: false,
  number: 0,
  integer: 0,
  string: '',
  array: [],
  object: {},
};

const typeOf = (value) => {
  if (value === undefined) {
    return 'undefined';
  }
  return Object.prototype.toString
    .call(value)
    .replace(/^\[object\s+([a-z]+)\]$/i, '$1')
    .toLowerCase();
};

const hasOwnProperty = (obj, prop) => {
  return obj === null || typeOf(obj) === 'undefined'
    ? false
    : Object.prototype.hasOwnProperty.call(obj, prop);
};

function traverseObj(obj, targetKey, handler) {
  if (typeOf(obj) === 'array') {
    for (const child of obj) {
      traverseObj(child, targetKey, handler);
    }
  } else if (typeOf(obj) === 'object') {
    for (const key in obj) {
      if (key === targetKey) {
        handler(obj[key]);
      } else {
        traverseObj(obj[key], targetKey, handler);
      }
    }
  }
}

/**
 * The default value wrapper class.
 */
class DefaultValue {
  /**
   * @param {any} value The wrapped default value.
   * @param {string} description A description of the contained value. Used to produce
   * the comment string.
   */
  constructor(value, description) {
    this.value = value;
    this.description = description;
  }

  /**
   * Duplicate the current default value.
   * &lt;p>
   * Wrapped value will be shallow copied.
   *
   * @returns {module:core/schema~DefaultValue} A new instance of the current default value.
   */
  clone() {
    const result = new DefaultValue(this.value, this.description);
    if (result.value instanceof DefaultValue) {
      result.value = result.value.clone();
    } else if (typeOf(result.value) === 'array') {
      result.value = [].concat(result.value);
    } else if (typeOf(result.value) === 'object') {
      result.value = Object.assign({}, result.value);
    }
    return result;
  }

  /**
   * Unwrap current {module:core/schema~DefaultValue} if its wrapped value is also a
   * {module:core/schema~DefaultValue}.
   * &lt;p>
   * The description will also be replaced with wrapped value description, if exists.
   */
  flatten() {
    if (this.value instanceof DefaultValue) {
      this.value.flatten();
      if (hasOwnProperty(this.value, 'description') &amp;&amp; this.value.description) {
        this.description = this.value.description;
      }
      this.value = this.value.value;
    }
  }

  /**
   * Merge current default value with another default value.
   *
   * @param {module:core/schema~DefaultValue} source The input object to be merged with. Should have the
   * same wrapped value type as current wrapped default value.
   */
  merge(source) {
    if (hasOwnProperty(source, 'value') &amp;&amp; source.value !== null) {
      this.flatten();
      if (source.value instanceof DefaultValue) {
        source = source.clone();
        source.flatten();
      }
      if (typeOf(source.value) === typeOf(this.value)) {
        if (typeOf(this.value) === 'array') {
          this.value = this.value.concat(source.value);
        } else if (typeOf(this.value) === 'object') {
          Object.keys(source.value).forEach((key) => {
            this.value[key] = source.value[key];
          });
        } else {
          this.value = source.value;
        }
      } else if (typeOf(this.value) === 'undefined' || typeOf(this.value) === 'null') {
        this.value = source.value;
      }
    }
    if (hasOwnProperty(source, 'description') &amp;&amp; source.description) {
      this.description = source.description;
    }
  }

  /**
   * Create a new array with comments inserted as new elements right before each child element.
   * &lt;p>
   * If current wrapped value is an array and some of its elements are instances of
   * {@link module:core/schema~DefaultValue}, the element's description will be inserted as a new child
   * right before the element.
   * The element itself will also be converted into its commented version using the &lt;code>toCommented&lt;/code>
   * method.
   *
   * @returns {Array} A new array with comments and the original elements in the commented form.
   */
  toCommentedArray() {
    return [].concat(
      ...this.value.map((item) => {
        if (item instanceof DefaultValue) {
          if (typeOf(item.description) !== 'string' || !item.description.trim()) {
            return [item.toCommented()];
          }
          return item.description
            .split('\n')
            .map((line, i) => {
              return MAGIC + i + ': ' + line;
            })
            .concat(item.toCommented());
        } else if (typeOf(item) === 'array' || typeOf(item) === 'object') {
          return new DefaultValue(item).toCommented();
        }
        return [item];
      }),
    );
  }

  /**
   * Create a new object with comments inserted as new properties right before every original properties.
   * &lt;p>
   * Works similar to {@link module:core/schema~DefaultValue#toCommentedArray}.
   *
   * @returns {Object} A new object with comments and the original property values in the commented form.
   */
  toCommentedObject() {
    if (this.value instanceof DefaultValue) {
      return this.value.toCommented();
    }
    const result = {};
    for (const key in this.value) {
      const item = this.value[key];
      if (item instanceof DefaultValue) {
        if (typeOf(item.description) === 'string' &amp;&amp; item.description.trim()) {
          item.description.split('\n').forEach((line, i) => {
            result[MAGIC + key + i] = line;
          });
        }
        result[key] = item.toCommented();
      } else if (typeOf(item) === 'array' || typeOf(item) === 'object') {
        result[key] = new DefaultValue(item).toCommented();
      } else {
        result[key] = item;
      }
    }
    return result;
  }

  /**
   * Call {@link module:core/schema~DefaultValue#toCommentedArray} or
   * {@link module:core/schema~DefaultValue#toCommentedObject} based on the type of the wrapped value.
   * &lt;p>
   * If neither applies, directly return the wrapped value.
   *
   * @returns {any} The commented object/array, or the original wrapped value.
   */
  toCommented() {
    if (typeOf(this.value) === 'array') {
      return this.toCommentedArray();
    } else if (typeOf(this.value) === 'object') {
      return this.toCommentedObject();
    }
    return this.value;
  }

  /**
   * Create the YAML string with all the comments from current default value.
   *
   * @returns {string} The formatted YAML string.
   */
  toYaml() {
    const regex = new RegExp("^(\\s*)(?:-\\s*\\')?" + MAGIC + ".*?:\\s*\\'?(.*?)\\'*$", 'mg');
    return yaml.stringify(this.toCommented()).replace(regex, '$1# $2'); // restore comments
  }
}

/* eslint-disable no-use-before-define */
/**
 * A class that can resolving referenced JSON schemas and create {@link module:core/schema~DefaultValue}s.
 */
class Schema {
  /**
   * @param {module:core/schema~SchemaLoader} loader JSON schema loader.
   * @param {Object} def The JSON schema definition.
   */
  constructor(loader, def) {
    if (!(loader instanceof SchemaLoader)) {
      throw new Error('loader must be an instance of SchemaLoader');
    }
    if (typeOf(def) !== 'object') {
      throw new Error('schema definition must be an object');
    }
    this.loader = loader;
    this.def = def;
    this.compiledSchema = null;
  }

  /**
   * Validate an object against the JSON schema.
   *
   * @param {any} obj Object to be validated.
   * @returns {boolean|Object} True if Object is valid, or validation errors.
   */
  validate(obj) {
    if (!this.compiledSchema) {
      this.compiledSchema = this.loader.compileValidator(this.def.$id);
    }
    return this.compiledSchema(obj) ? true : this.compiledSchema.errors;
  }

  /**
   * Create the {@link module:core/schema~DefaultValue} for an array-typed JSON schema.
   * &lt;p>
   * Each possible type of the array elements defined in &lt;code>oneOf&lt;/code> will be processed and a
   * {@link module:core/schema~DefaultValue} will be added to the result array.
   *
   * @param {Object} def JSON schema definition of the array.
   * @returns {@link module:core/schema~DefaultValue} The {@link module:core/schema~DefaultValue} for the
   * array definition.
   */
  getArrayDefaultValue(def) {
    const defaultValue = new DefaultValue(null, def.description);
    // all array elements have the same type, return the default value for that type
    if (typeOf(def.items) === 'object') {
      const items = Object.assign({}, def.items);
      delete items.oneOf;
      let value = this.getDefaultValue(items);
      // additionally, if each array element can be in one of the provided types in &lt;code>oneOf&lt;/code>
      if (typeOf(def.items.oneOf) === 'array') {
        // for each &lt;code>oneOf&lt;/code> element, return a {@link module:core/schema~DefaultValue}
        defaultValue.value = def.items.oneOf.map((one) => {
          // if the &lt;code>items&lt;/code> definition also exists, merge it with the &lt;code>oneOf&lt;/code>
          // {@link module:core/schema~DefaultValue}
          const clone = value.clone();
          clone.merge(this.getDefaultValue(one));
          return clone;
        });
      } else {
        if (typeOf(value) !== 'array') {
          value = [value];
        }
        defaultValue.value = value;
      }
    }
    return defaultValue;
  }

  /**
   * Create the {@link module:core/schema~DefaultValue} for an object-typed JSON schema.
   * &lt;p>
   * The first possible type of the object element defined in &lt;code>oneOf&lt;/code> will be processed and its
   * {@link module:core/schema~DefaultValue} will be merged with the {@link module:core/schema~DefaultValue}
   * created from the &lt;code>properties&lt;/code> definition.
   *
   * @param {Object} def JSON schema definition of the object.
   * @returns {@link module:core/schema~DefaultValue} The {@link module:core/schema~DefaultValue} for the
   * object definition.
   */
  getObjectDefaultValue(def) {
    const value = {};
    if (typeOf(def.properties) === 'object') {
      for (const property in def.properties) {
        value[property] = this.getDefaultValue(def.properties[property]);
      }
    }
    const defaultValue = new DefaultValue(value, def.description);
    // only the first one of the possible types will be merged with {@link module:core/schema~DefaultValue}
    // for the &lt;code>properties&lt;/code> definition.
    if (typeOf(def.oneOf) === 'array' &amp;&amp; def.oneOf.length) {
      defaultValue.merge(this.getDefaultValue(def.oneOf[0]));
      defaultValue.description = def.description;
    }
    return defaultValue;
  }

  /**
   * Create the {@link module:core/schema~DefaultValue} for any typed JSON schema that is not purely defined
   * by its &lt;code>$ref&lt;/code>.
   * &lt;p>
   * If the definition also contains a &lt;code>$ref&lt;/code>, the {@link module:core/schema~DefaultValue} for the
   * &lt;code>$ref&lt;/code> definition will be merged to the {@link module:core/schema~DefaultValue} of the current
   * definition.
   * &lt;p>
   * If &lt;code>type&lt;/code> of the JSON schema is of primitive types, and the &lt;code>nullable&lt;/code> is set to
   * &lt;code>false&lt;/code> in the schema definition, primitive default values will be set insided the result
   * {@link module:core/schema~DefaultValue}.
   *
   * @param {Object} def JSON schema definition.
   * @returns {@link module:core/schema~DefaultValue} The {@link module:core/schema~DefaultValue} for the
   * definition.
   * @throws {Error} If &lt;code>type&lt;/code> is undefined or it is 'array', 'object', or primitive types.
   */
  getTypedDefaultValue(def) {
    let defaultValue;
    const type = typeOf(def.type) === 'array' ? def.type[0] : def.type;
    if (type === 'array') {
      defaultValue = this.getArrayDefaultValue(def);
    } else if (type === 'object') {
      defaultValue = this.getObjectDefaultValue(def);
    } else if (hasOwnProperty(PRIMITIVE_DEFAULTS, type)) {
      if (hasOwnProperty(def, 'nullable') &amp;&amp; def.nullable) {
        defaultValue = new DefaultValue(null, def.description);
      } else {
        defaultValue = new DefaultValue(PRIMITIVE_DEFAULTS[type], def.description);
      }
    } else {
      throw new Error(`Cannot get default value for type ${type}`);
    }
    // referred default value always get overwritten by its parent default value
    if (hasOwnProperty(def, '$ref') &amp;&amp; def.$ref) {
      const refDefaultValue = this.getReferredDefaultValue(def);
      refDefaultValue.merge(defaultValue);
      defaultValue = refDefaultValue;
    }
    return defaultValue;
  }

  /**
   * Create the {@link module:core/schema~DefaultValue} for any JSON schema that is purely defined by its
   * &lt;code>$ref&lt;/code>.
   *
   * @param {Object} def JSON schema definition.
   * @returns {@link module:core/schema~DefaultValue} The {@link module:core/schema~DefaultValue} for the
   * definition.
   */
  getReferredDefaultValue(def) {
    const schema = this.loader.getSchema(def.$ref);
    if (!schema) {
      throw new Error(`Schema ${def.$ref} is not loaded`);
    }
    const defaultValue = this.getDefaultValue(schema.def);
    defaultValue.merge({ description: def.description });
    return defaultValue;
  }

  /**
   * Create the {@link module:core/schema~DefaultValue} for any JSON schema.
   *
   * @param {Object} def JSON schema definition.
   * @returns {@link module:core/schema~DefaultValue} The {@link module:core/schema~DefaultValue} for the
   * definition.
   */
  getDefaultValue(def = null) {
    if (!def) {
      def = this.def;
    }
    if (hasOwnProperty(def, 'const')) {
      return new DefaultValue(def.const, def.description);
    }
    if (hasOwnProperty(def, 'default')) {
      return new DefaultValue(def.default, def.description);
    }
    if (
      hasOwnProperty(def, 'examples') &amp;&amp;
      typeOf(def.examples) === 'array' &amp;&amp;
      def.examples.length
    ) {
      return new DefaultValue(def.examples[0], def.description);
    }
    if (hasOwnProperty(def, 'type') &amp;&amp; def.type) {
      return this.getTypedDefaultValue(def);
    }
    // $ref only schemas
    if (hasOwnProperty(def, '$ref') &amp;&amp; def.$ref) {
      return this.getReferredDefaultValue(def);
    }
    throw new Error(
      'The following schema definition must have at least one of the ' +
        '["const", "default", "examples", "type", "$ref"] fields:\n' +
        JSON.stringify(def, null, 2),
    );
  }
}

/**
 * Class for loading JSON schema files from filesystems and creating validator.
 */
class SchemaLoader {
  constructor() {
    this.schemas = {};
    this.ajv = new Ajv({ allowUnionTypes: true });
  }

  /**
   * Get JSON schema definition by its &lt;code>$id&lt;/code>.
   *
   * @param {string} $id JSON schema &lt;code>$id&lt;/code>.
   * @returns {Object} JSON schema definition.
   */
  getSchema($id) {
    return this.schemas[$id];
  }

  /**
   * Add a JSON schema definition to the collection.
   *
   * @param {Object} JSON schema definition.
   * @throws {Error} If JSON schema definition does not have an &lt;code>$id&lt;/code>.
   */
  addSchema(def) {
    if (!hasOwnProperty(def, '$id')) {
      throw new Error('The schema definition does not have an $id field');
    }
    this.ajv.addSchema(def);
    this.schemas[def.$id] = new Schema(this, def);
  }

  /**
   * Remove a JSON schema definition to the collection.
   *
   * @param {string} $id JSON schema &lt;code>$id&lt;/code>.
   */
  removeSchema($id) {
    this.ajv.removeSchema($id);
    delete this.schemas[$id];
  }

  /**
   * Create a JSON schema validation function for a given schema identified by its &lt;code>$id&lt;/code>.
   *
   * @param {*} $id $id JSON schema &lt;code>$id&lt;/code>.
   * @returns {Function} JSON schema validation function.
   */
  compileValidator($id) {
    return this.ajv.compile(this.getSchema($id).def);
  }
}

/**
 * Create a {@link module:core/schema~SchemaLoader} and load all referred JSON schema from the resolve
 * directories.
 *
 * @param {Object} rootSchemaDef The root JSON schema definition.
 * @param {Array} resolveDirs Additional directories for resolving referred JSON schemas besides the
 * &lt;code>lib/schema&lt;/code> folder in this library. Directory order matters.
 * @returns {@link module:core/schema~SchemaLoader} The schema loader with all referred schemas loaded.
 * @throws {Error} Referred schema not found in any of the resolve directories.
 */
SchemaLoader.load = (rootSchemaDef, resolveDirs = []) => {
  if (typeOf(resolveDirs) !== 'array') {
    resolveDirs = [resolveDirs];
  }
  resolveDirs.push(path.join(__dirname, '../schema/'));

  const loader = new SchemaLoader();
  loader.addSchema(rootSchemaDef);

  function handler($ref) {
    if (loader.getSchema($ref)) {
      return;
    }
    for (const dir of resolveDirs) {
      let def;
      try {
        def = require(path.join(dir, $ref));
      } catch (e) {
        continue;
      }
      if (typeOf(def) !== 'object' || def.$id !== $ref) {
        continue;
      }
      loader.addSchema(def);
      traverseObj(def, '$ref', handler);
      return;
    }
    throw new Error(
      'Cannot find schema definition ' +
        $ref +
        '.\n' +
        'Please check if the file exists and its $id is correct',
    );
  }

  traverseObj(rootSchemaDef, '$ref', handler);
  return loader;
};

module.exports = {
  MAGIC,
  Schema,
  SchemaLoader,
  DefaultValue,
};
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.11</a> on Wed Dec 14 2022 17:29:19 GMT+0000 (Coordinated Universal Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
